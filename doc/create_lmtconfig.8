.TH CREATE_LMTCONFIG 8 LMT LLNL CREATE_LMTCONFIG
.SH NAME
create_lmtconfig \- set up the lmt mysql database
.SH SYNOPSIS
.B "create_lmtconfig [-r] [-a] [-d] [-t] -f <configfile>"
.br



.SH DESCRIPTION
.B create_lmtconfig
prints out a mysql script to standard out that sets up a database for LMT.
Please look below for information on the configuration file.



.SH OPTIONS
.B create_lmtconfig
accepts the following options:
.TP
.I "-r"
Create the mysql root user account (generates a random password for the
root user).
.TP
.I "-a"
Create the mysql users lwatchadmin(read/write account),
lwatchclient(read account).
.TP
.I "-d"
Create the database for your filesystem (each filesystem has its own
database and you can have multiple filesystems configured for a particular
mysql installation).
.TP
.I "-t"
Create the necessary tables for the database (should be used along with -d)
.TP
.I "-f"
Specify the configuration file to use for your filesystem.



.SH CONFIGURATION_FILE
.TP
The LMT configuration file is broken into 5 separate sections.



.TP
The first section is named the
.B filesystem
section.
This particular section defines the name of the filesystem as well
as where the indended mountpoint will be.
The fields that are allowed in this section are:
.TP
.I "name <fsname>"
Specify the filesystem name as <fsname>.
.TP
.I "mountpoint <mountpoint>"
Spcicify the mount directory as <mountpoint>.



.TP
The second section is named the
.B mds
section.
This particular secion defines properties about the metadata server for
filesystem <fsname>.
The fields that are allowed in this section are:
.TP
.I "name <hostrange>"
Specify the set of mds nodes with <hostrange>.
.TP
.I "uuid <uuidrange>"
Spcicify the set of uuids as <uuidrange>.  Note that the number of
uuids here must match exactly with the number of hosts spcified with
<hostrange> above.  The first uuid will be paired with the first hostname,
and so on.
.TP
.I device <devicename>
Specify the device that will exist on each mds node.



.TP
The third section is named the
.B ost
section.
This particular secion defines properties about the object storage servers/targets
for filesystem <fsname>.
.TP
.I "name <hostrange>"
Specify the set of oss nodes with <hostrange>.
.TP
.I "uuid <uuidrange>"
Specify the set of ost uuids as <uuidrange>.  Note that the number of
uuids here must match exactly with the total number of osts spcified
for this system (number of oss nodes * number of devices).  The first uuid
will be paired with the first hostname, and so on.
There are a few special macros that are used here to help define uuids:
"{HEXINDEX}" is replaced with a 4 digit hexadecimal number that corresponds
with the ost index for the entire filesystem.
"{INDEX}" is replaced with an integer that corresponds with the ost index
on a particular oss.
"{_INDEX}" is replaced with an integer that corresponds with the ost index
on a particular oss.  The difference here from {INDEX} is that the integer
is preceded by un underscore.  If the value for the index is 1 then neither
the underscore or the integer are printed out.

.TP
.I "foname <hostrange>"
Specify the set of failover hosts as <hostrange>.  Note that the number of
hosts here must match exactly with the number of hosts specified with
<hostrange> above.  The first failover host will be paired with the first
hostname, and so on.  A hostname of NONE specified means that a particular
host does not have a failover partner.
.TP
.I "skip <skipvalue>"
Specify the <skipvalue>.  This value defines how osts should be allocated
across the <hostrange>.  As an example for a set of nodes that have 3 osts on
each oss a <skipvalue> of 4 means that
node1 will be allocated device1, node2 device2, node3 device3, node4 device4,
node1 device5, node2 device6, and so on...
.TP
.I "device <deviceset>"
Specify the devices that will exist on each oss node.
The special parameter "{NODENAME}" used here expands to the name of the
particular oss node.
.TP
.I "fodevice <fodeviceset>"
Specify the failover devices that will exist on each oss node.
The special parameter "{FONODENAME}" used here expands to the name of the
particular failover oss node.



.TP
The fourth section is named the
.B router
section.
This particular secion defines properties about the LNET routers for filesystem
<fsname>.
.TP
.I "name <hostrange>"
Specify the set of router nodes with <hostrange>.



.TP
The fifth section is named the
.B client
section.
Currently the client section is not really used.
.TP
.I "name <clientconfigname>"
Specify the name of the client configuration file with <clientconfigname>.


.SH EXAMPLE CONFIGURATION FILE
.TP
Here is an example of a configuration file for create_lmtconfig:

 filesystem
 {
     name crater
     mountpoint /p/crater
 }
 
 mds
 {
     name igs-mds1
     uuid mds_p_crater
     device /dev/sda
 }
 
 ost
 {
     name igs[1-23]
     uuid OST_{NODENAME}{_INDEX}
     foname igs[5-8,1-4,13-16,9-12,21-23],NONE,igs[17-19]
     skip 8
     device /dev/lustre/normal/OST_{NODENAME},/dev/lustre/normal/OST_{NODENAME}_2,/dev/lustre/normal/OST_{NODENAME}_3
     fodevice /dev/lustre/failover/OST_{FONODENAME},/dev/lustre/failover/OST_{FONODENAME}_2,/dev/lustre/failover/OST_{FONODENAME}_3
 }
 
 router
 {
     name alc[4-19],atlas[64-71,504-511,640-647,1080-1087]
 }
 
 client
 {
     name crater_client
 }
